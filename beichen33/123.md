整个项目就在这个beichen33的目录下创建；节约token，不要写中文和任何注释。
# 北辰幼儿园管理系统 - 完整 AI CLI 提示词

## 📋 项目概述提示词

```markdown
我需要创建一个完整的幼儿园管理系统，请使用以下技术栈从零开始搭建：

【项目名称】北辰幼儿园综合管理系统

【技术栈要求】
- 后端框架：NestJS (TypeScript)
- 数据库：PostgreSQL
- ORM：Prisma
- 前端：React 18 + TypeScript + Vite
- UI 框架：Ant Design 5.x
- 状态管理：Zustand
- 数据请求：TanStack Query (React Query)
- 打印：react-to-print + html2pdf.js
- 部署：Docker Compose

【业务规模】
- 学生数量：约 200 人
- 班级数量：10 个班（小班、中班、大班）
- 教职工：20-30 人
- 数据保留：3 年周期

【核心功能模块】
1. 表单管理系统（动态表单创建、填写、审批）
2. 学生档案管理（基本信息、成长记录）
3. 班级管理（班级信息、学生分配）
4. 食堂营养分析（菜品管理、营养成分计算、每日食谱）
5. 文字记录统计（日常观察记录、行为记录、学习记录）
6. 打印模块（所有数据支持 A4 标准格式打印）
7. 数据查询统计（多维度查询、图表展示）

【核心要求】
✅ 所有数据库表必须是关系型设计（不使用 JSONB 存储核心业务数据）
✅ 每个功能模块都要有完善的查询和打印功能
✅ 前端界面清晰，适合教师使用
✅ API 设计符合 RESTful 规范
✅ 代码结构清晰，易于维护和扩展
✅ 使用 TypeScript 严格模式，确保类型安全
✅ 打印功能使用标准 A4 纸规格（210mm × 297mm）

【代码风格】
- 使用函数式组件（React Hooks）
- API 路由使用 Swagger 自动生成文档
- 数据库操作使用 Prisma 事务确保一致性
- 错误处理统一使用 try-catch 和全局异常过滤器
- 所有时间使用 UTC 存储，前端显示时转换为本地时间

【部署要求】
- 使用 Docker Compose 一键部署
- 支持数据备份和恢复
- 环境变量配置敏感信息
- 生产环境使用 Nginx 反向代理

请按照以上要求，帮我生成完整的项目结构、数据库设计和核心代码。
```

---

## 🗄️ 数据库设计提示词

```markdown
请为北辰幼儿园管理系统设计完整的数据库 Schema，使用 Prisma 格式输出。

【核心实体关系】

1. 用户相关（Users）
   - 管理员、教师、家长
   - 角色权限管理

2. 学生相关（Students）
   - 学生基本信息（姓名、性别、出生日期、入园日期）
   - 与班级的多对一关系
   - 与家长的多对多关系
   - 健康档案（身高、体重、过敏史）

3. 班级相关（Classes）
   - 班级信息（名称、年级、班主任）
   - 与学生的一对多关系

4. 成长记录（GrowthRecords）
   - 关联学生
   - 记录类型（学习、生活、健康、行为）
   - 记录内容（文字、图片）
   - 记录时间、记录教师
   - 支持标签分类

5. 食堂管理
   - 食材表（Ingredients）：名称、单位、蛋白质、脂肪、碳水化合物、热量、成本
   - 菜品表（Dishes）：名称、类别、价格
   - 菜品食材关联表（DishIngredients）：菜品ID、食材ID、用量
   - 食谱表（Menus）：日期、餐次（早餐、午餐、晚餐、加餐）
   - 食谱菜品关联表（MenuDishes）：食谱ID、菜品ID

6. 表单系统
   - 表单模板（FormTemplates）：标题、描述、字段定义
   - 表单提交（FormSubmissions）：关联表单模板、提交人、提交数据
   - 审批流程（ApprovalFlows）：审批步骤、审批人、审批状态

7. 统计报表配置
   - 报表模板（ReportTemplates）：报表名称、查询SQL、打印模板

【数据库约束要求】
- 所有主键使用 UUID
- 所有表必须有 created_at 和 updated_at 字段
- 删除操作使用软删除（deleted_at）
- 外键关联使用 ON DELETE CASCADE 或 ON DELETE SET NULL
- 建立必要的索引提高查询性能
- 重要字段添加 NOT NULL 约束

【输出格式】
请输出完整的 schema.prisma 文件内容，包括：
1. 数据源配置
2. 所有模型定义
3. 关系定义
4. 索引定义

并提供迁移命令和初始化数据脚本。
```

---

## 🏗️ 项目结构生成提示词

```markdown
请为北辰幼儿园管理系统生成完整的项目目录结构，包含前后端代码组织方式。

【后端目录结构（NestJS）】
/backend
├── prisma/
│   ├── schema.prisma          # 数据库 Schema
│   ├── migrations/            # 数据库迁移文件
│   └── seed.ts                # 初始化数据脚本
├── src/
│   ├── main.ts                # 应用入口
│   ├── app.module.ts          # 根模块
│   ├── common/                # 公共模块
│   │   ├── decorators/        # 装饰器
│   │   ├── filters/           # 异常过滤器
│   │   ├── guards/            # 守卫
│   │   ├── interceptors/      # 拦截器
│   │   └── pipes/             # 管道
│   ├── modules/
│   │   ├── auth/              # 认证模块
│   │   ├── users/             # 用户管理
│   │   ├── students/          # 学生管理
│   │   ├── classes/           # 班级管理
│   │   ├── growth-records/    # 成长记录
│   │   ├── canteen/           # 食堂管理
│   │   │   ├── ingredients/   # 食材管理
│   │   │   ├── dishes/        # 菜品管理
│   │   │   ├── menus/         # 食谱管理
│   │   │   └── nutrition/     # 营养分析
│   │   ├── forms/             # 表单系统
│   │   ├── reports/           # 报表统计
│   │   └── print/             # 打印模块
│   └── config/                # 配置文件
├── test/                      # 测试文件
├── docker-compose.yml
├── Dockerfile
├── .env.example
├── package.json
└── tsconfig.json

【前端目录结构（React + Vite）】
/frontend
├── public/
│   └── print-templates/       # 打印模板
├── src/
│   ├── main.tsx               # 应用入口
│   ├── App.tsx                # 根组件
│   ├── routes/                # 路由配置
│   ├── pages/                 # 页面组件
│   │   ├── Dashboard/         # 仪表盘
│   │   ├── Students/          # 学生管理
│   │   │   ├── List.tsx
│   │   │   ├── Detail.tsx
│   │   │   └── GrowthRecords.tsx
│   │   ├── Classes/           # 班级管理
│   │   ├── Canteen/           # 食堂管理
│   │   │   ├── Ingredients.tsx
│   │   │   ├── Dishes.tsx
│   │   │   ├── Menus.tsx
│   │   │   └── Nutrition.tsx
│   │   ├── Forms/             # 表单系统
│   │   ├── Reports/           # 统计报表
│   │   └── Print/             # 打印预览
│   ├── components/            # 可复用组件
│   │   ├── Layout/
│   │   ├── Table/
│   │   ├── Form/
│   │   ├── Chart/
│   │   └── PrintTemplate/
│   ├── hooks/                 # 自定义 Hooks
│   ├── services/              # API 服务
│   │   └── api.ts
│   ├── store/                 # 状态管理
│   ├── utils/                 # 工具函数
│   │   ├── print.ts
│   │   ├── nutrition.ts
│   │   └── format.ts
│   ├── types/                 # TypeScript 类型
│   └── styles/                # 样式文件
├── index.html
├── vite.config.ts
├── tsconfig.json
└── package.json

请为每个关键文件生成基础代码框架，包括必要的导入和类型定义。
```

---

## 🍽️ 食堂营养分析模块提示词

```markdown
请为食堂营养分析模块生成完整的代码，包括后端 API 和前端界面。

【功能需求】

1. 食材管理
   - 食材录入（名称、单位、营养成分：蛋白质、脂肪、碳水、热量、维生素）
   - 食材列表查询（支持搜索、分页）
   - 食材编辑和删除

2. 菜品管理
   - 创建菜品（名称、类别：主食/荤菜/素菜/汤/水果）
   - 为菜品添加食材（选择食材、输入用量）
   - 自动计算菜品营养成分（根据食材用量汇总）
   - 支持多层级 BOM（菜品可以包含半成品）

3. 食谱管理
   - 创建每日食谱（选择日期、餐次）
   - 为食谱添加菜品
   - 查看食谱总营养成分
   - 营养分析报告（蛋白质、脂肪、碳水比例是否合理）

4. 营养查询
   - 按日期范围查询学生摄入营养
   - 按学生查询历史营养摄入
   - 营养趋势图表展示

5. 打印功能
   - 打印每日食谱（含营养成分表）
   - 打印每周食谱汇总
   - 打印营养分析报告

【技术实现要求】

后端 API：
```typescript
// 自动计算菜品营养成分的核心逻辑
async calculateDishNutrition(dishId: string) {
  // 1. 查询菜品包含的所有食材及用量
  // 2. 遍历食材，按用量计算各营养成分
  // 3. 汇总返回总营养成分
  // 4. 使用 Prisma 事务确保数据一致性
}

// API 接口设计
POST   /api/canteen/dishes              // 创建菜品
GET    /api/canteen/dishes              // 获取菜品列表
GET    /api/canteen/dishes/:id          // 获取菜品详情（含营养成分）
PUT    /api/canteen/dishes/:id          // 更新菜品
DELETE /api/canteen/dishes/:id          // 删除菜品

POST   /api/canteen/menus               // 创建食谱
GET    /api/canteen/menus?date=2025-01-15  // 获取指定日期食谱
GET    /api/canteen/menus/:id/nutrition    // 获取食谱营养分析

GET    /api/canteen/reports/nutrition   // 营养分析报表
  ?startDate=2025-01-01
  &endDate=2025-01-31
  &studentId=xxx (可选)
```

前端界面：
- 食材管理：表格 + 表单对话框
- 菜品管理：左侧菜品列表，右侧食材配置（支持拖拽排序）
- 食谱管理：日历视图 + 菜品选择器
- 营养分析：饼图展示营养占比，折线图展示趋势

打印模板：
- A4 纸规格
- 包含幼儿园 logo 和名称
- 食谱表格（菜品名称、食材、用量、营养成分）
- 营养成分汇总表
- 页眉页脚（日期、页码）

请生成完整的代码，包括：
1. Prisma Schema（食材、菜品、菜品食材关联表）
2. NestJS Service 和 Controller
3. React 前端页面组件
4. 打印模板组件
5. 营养计算工具函数
```

---

## 📝 学生成长记录模块提示词

```markdown
请为学生成长记录模块生成完整的代码。

【功能需求】

1. 记录类型
   - 学习记录（课堂表现、作业完成、技能掌握）
   - 生活记录（饮食、午睡、卫生习惯）
   - 健康记录（身高、体重、疾病、疫苗接种）
   - 行为记录（社交互动、情绪表现、特殊事件）
   - 作品记录（绘画、手工、表演，支持上传图片）

2. 记录功能
   - 快速记录（选择学生、记录类型、输入内容）
   - 批量记录（为整个班级记录相同内容）
   - 富文本编辑（支持文字格式、插入图片）
   - 标签分类（为记录添加标签，便于检索）

3. 查询功能
   - 按学生查询（查看某学生所有记录）
   - 按时间段查询（查看某时间段内的记录）
   - 按类型查询（只看学习记录或健康记录）
   - 按标签查询（查找特定标签的记录）
   - 高级搜索（多条件组合查询）

4. 统计分析
   - 学生成长轨迹图（时间轴展示）
   - 健康趋势图（身高体重变化曲线）
   - 学习进度分析（各项技能掌握情况）
   - 班级对比分析（与同龄儿童对比）

5. 打印功能
   - 打印学生成长档案（完整记录汇总）
   - 打印学期总结报告（按学期统计分析）
   - 打印健康体检报告
   - 打印家长反馈表

【数据库设计】

```prisma
model GrowthRecord {
  id          String   @id @default(uuid())
  studentId   String
  student     Student  @relation(fields: [studentId], references: [id])
  
  type        RecordType  // LEARNING, LIFE, HEALTH, BEHAVIOR, ARTWORK
  category    String?     // 二级分类
  title       String
  content     String      // 记录内容（支持 Markdown）
  images      String[]    // 图片 URL 数组
  tags        String[]    // 标签数组
  
  recordedBy  String      // 记录教师
  recordedAt  DateTime    // 记录时间
  
  // 健康记录专用字段
  height      Float?      // 身高 (cm)
  weight      Float?      // 体重 (kg)
  
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
  
  @@index([studentId, recordedAt])
  @@index([type])
}
```

【API 接口】

```typescript
// 创建记录
POST   /api/growth-records
Body: {
  studentId: string;
  type: 'LEARNING' | 'LIFE' | 'HEALTH' | 'BEHAVIOR' | 'ARTWORK';
  title: string;
  content: string;
  images?: string[];
  tags?: string[];
  height?: number;
  weight?: number;
}

// 查询记录
GET    /api/growth-records
Query: {
  studentId?: string;
  type?: string;
  startDate?: string;
  endDate?: string;
  tags?: string[];
  page?: number;
  limit?: number;
}

// 获取学生成长轨迹
GET    /api/growth-records/timeline/:studentId
Response: {
  records: GrowthRecord[];
  healthTrend: { date: string; height: number; weight: number }[];
  tags: { tag: string; count: number }[];
}

// 生成成长报告
GET    /api/growth-records/report/:studentId
Query: {
  startDate: string;
  endDate: string;
  type: 'SEMESTER' | 'ANNUAL';
}
```

【前端界面】

1. 记录列表页
   - 左侧：筛选面板（学生选择、时间范围、记录类型）
   - 右侧：记录卡片列表（时间线展示）
   - 顶部：快速记录按钮、批量操作

2. 记录详情页
   - 记录内容展示（富文本渲染）
   - 图片预览（点击放大）
   - 关联信息（学生信息、记录教师）
   - 操作按钮（编辑、删除、打印）

3. 成长轨迹页
   - 时间轴组件（垂直展示所有记录）
   - 健康趋势图（ECharts 折线图）
   - 标签云（展示常用标签）
   - 统计卡片（总记录数、各类型占比）

4. 打印模板
   - A4 纸规格
   - 学生基本信息（照片、姓名、班级）
   - 记录列表（按时间倒序）
   - 健康数据表格
   - 教师评语
   - 家长签字栏

请生成完整代码，包括前后端实现和打印模板。
```

---

## 🖨️ 通用打印模块提示词

```markdown
请创建一个通用的打印模块，支持所有业务数据的 A4 标准打印。

【打印需求】

1. 支持的打印类型
   - 学生档案卡
   - 成长记录报告
   - 食谱营养表
   - 班级名单
   - 考勤统计表
   - 表单提交记录
   - 自定义报表

2. 打印格式要求
   - 纸张：A4 (210mm × 297mm)
   - 页边距：上下 20mm，左右 15mm
   - 页眉：幼儿园名称、Logo、打印日期
   - 页脚：页码、打印人
   - 支持分页（内容超过一页自动分页）
   - 支持页眉页脚重复显示

3. 打印方式
   - 浏览器打印（window.print）
   - 导出 PDF（保存到本地）
   - 批量打印（选择多个记录一次性打印）

【技术实现】

使用技术：
- react-to-print (React 打印组件)
- html2canvas (HTML 转图片)
- jsPDF (生成 PDF)

核心代码结构：

```typescript
// 打印模板基类
interface PrintTemplate {
  title: string;
  data: any;
  header?: React.ReactNode;
  footer?: React.ReactNode;
}

// 通用打印组件
function PrintTemplate({ title, data, children }: PrintTemplate) {
  return (
    <div className="print-container">
      {/* 页眉 */}
      <div className="print-header">
        <img src="/logo.png" alt="幼儿园Logo" />
        <h1>北辰幼儿园</h1>
        <span>打印日期：{format(new Date(), 'yyyy-MM-dd')}</span>
      </div>

      {/* 内容区域 */}
      <div className="print-content">
        <h2>{title}</h2>
        {children}
      </div>

      {/* 页脚 */}
      <div className="print-footer">
        <span>打印人：XXX</span>
        <span className="page-number"></span>
      </div>
    </div>
  );
}

// 打印样式 (CSS)
@media print {
  @page {
    size: A4;
    margin: 20mm 15mm;
  }

  body {
    print-color-adjust: exact;
    -webkit-print-color-adjust: exact;
  }

  .no-print {
    display: none !important;
  }

  .print-container {
    page-break-inside: avoid;
  }

  .print-header, .print-footer {
    position: fixed;
  }

  .print-header {
    top: 0;
  }

  .print-footer {
    bottom: 0;
  }
}
```

【具体打印模板】

1. 学生档案打印模板
```tsx
function StudentProfilePrint({ student }: { student: Student }) {
  return (
    <PrintTemplate title="学生档案卡" data={student}>
      <div className="student-profile">
        <div className="photo">
          <img src={student.avatar} alt={student.name} />
        </div>
        <div className="info">
          <table>
            <tr><td>姓名：</td><td>{student.name}</td></tr>
            <tr><td>性别：</td><td>{student.gender}</td></tr>
            <tr><td>出生日期：</td><td>{format(student.birthday, 'yyyy-MM-dd')}</td></tr>
            <tr><td>班级：</td><td>{student.class.name}</td></tr>
            <tr><td>家长姓名：</td><td>{student.parent.name}</td></tr>
            <tr><td>联系电话：</td><td>{student.parent.phone}</td></tr>
          </table>
        </div>
      </div>
    </PrintTemplate>
  );
}
```

2. 食谱打印模板
```tsx
function MenuPrint({ menu }: { menu: Menu }) {
  return (
    <PrintTemplate title={`${format(menu.date, 'yyyy年MM月dd日')} 食谱`} data={menu}>
      <table className="menu-table">
        <thead>
          <tr>
            <th>餐次</th>
            <th>菜品</th>
            <th>食材</th>
            <th>蛋白质(g)</th>
            <th>脂肪(g)</th>
            <th>热量(kcal)</th>
          </tr>
        </thead>
        <tbody>
          {menu.menuDishes.map(md => (
            <tr key={md.id}>
              <td>{md.mealType}</td>
              <td>{md.dish.name}</td>
              <td>{md.dish.ingredients.join(', ')}</td>
              <td>{md.dish.protein}</td>
              <td>{md.dish.fat}</td>
              <td>{md.dish.calories}</td>
            </tr>
          ))}
        </tbody>
        <tfoot>
          <tr>
            <td colSpan="3">合计</td>
            <td>{menu.totalProtein}</td>
            <td>{menu.totalFat}</td>
            <td>{menu.totalCalories}</td>
          </tr>
        </tfoot>
      </table>
    </PrintTemplate>
  );
}
```

3. 成长记录打印模板
```tsx
function GrowthReportPrint({ student, records }: Props) {
  return (
    <PrintTemplate title={`${student.name} 成长记录报告`}>
      <div className="student-info">
        <img src={student.avatar} />
        <div>
          <p>姓名：{student.name}</p>
          <p>班级：{student.class.name}</p>
          <p>统计时间：{startDate} ~ {endDate}</p>
        </div>
      </div>

      <section className="health-trend">
        <h3>健康趋势</h3>
        <LineChart data={healthData} />
      </section>

      <section className="records">
        <h3>成长记录</h3>
        {records.map(record => (
          <div className="record-item" key={record.id}>
            <div className="date">{format(record.recordedAt, 'yyyy-MM-dd')}</div>
            <div className="type">{record.type}</div>
            <div className="content">{record.content}</div>
            {record.images && (
              <div className="images">
                {record.images.map(img => <img src={img} key={img} />)}
              </div>
            )}
          </div>
        ))}
      </section>
    </PrintTemplate>
  );
}
```

请生成完整的打印模块代码，包括：
1. 通用打印组件
2. 各业务模块的打印模板
3. 打印样式 CSS
4. 打印预览和导出 PDF 功能
5. 批量打印功能
```

---
端口号用8890以上的防止冲突。
